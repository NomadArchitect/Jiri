{
  "comments": [
    {
      "key": {
        "uuid": "e541c27a_068d0032",
        "filename": "scripts/bootstrap_jiri",
        "patchSetId": 5
      },
      "lineNbr": 89,
      "author": {
        "id": 5030
      },
      "writtenOn": "2016-08-25T22:15:46Z",
      "side": 1,
      "message": "pass \"-f\" to curl to make it generate non-zero exit codes on failures it can detect (like 404s, 500s, etc)",
      "revId": "6621836c88d4396be5593fb6f078ece6b6efbd46",
      "serverId": "ccdefb6c-23ea-33ff-848c-339fc6ca2269",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "e541c27a_35ce5b2f",
        "filename": "scripts/bootstrap_jiri",
        "patchSetId": 5
      },
      "lineNbr": 89,
      "author": {
        "id": 5015
      },
      "writtenOn": "2016-08-26T17:21:55Z",
      "side": 1,
      "message": "i can\u0027t rely on just adding -f here because the error output of curl is insufficient: \"curl: (22) The requested URL returned error: 404 Not Found\".  on top of that, even if i add -f, `set -x` won\u0027t stop the script because i\u0027m storing the result of the command so `set -x` is (correctly) ignored.\n\nideally, you would check $? after the assignment to ensure the command substitution succeeded:\nfoo\u003d$(false)\nif [[ $? ]]; then echo \"foo failed\"; fi\n\nhowever, readonly seems to muck that up:\nreadonly foo\u003d$(false)\necho $?  # always prints 0",
      "parentUuid": "e541c27a_068d0032",
      "revId": "6621836c88d4396be5593fb6f078ece6b6efbd46",
      "serverId": "ccdefb6c-23ea-33ff-848c-339fc6ca2269",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "c56d9e44_44644eef",
        "filename": "scripts/bootstrap_jiri",
        "patchSetId": 5
      },
      "lineNbr": 89,
      "author": {
        "id": 5015
      },
      "writtenOn": "2016-08-26T17:29:10Z",
      "side": 1,
      "message": "after some more experimentation, i think -sSf might be the best option.\n\n-sf alone causes curl to fail but there\u0027s no server output.  so we can see the url but not the error\n\n-sSf output ends up looking like:\n\ncurl: (22) The requested URL returned error: 400 Bad Request\nEncoded jiri version does not look like base64\nURL: https://fuchsia.googlesource.com/jiri/version/+/master/bootstrap/linux-amd64?format\u003dDNE\n\nMaybe linux-amd64 isn\u0027t supported?",
      "parentUuid": "e541c27a_35ce5b2f",
      "revId": "6621836c88d4396be5593fb6f078ece6b6efbd46",
      "serverId": "ccdefb6c-23ea-33ff-848c-339fc6ca2269",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "e541c27a_11e1bcc2",
        "filename": "scripts/bootstrap_jiri",
        "patchSetId": 5
      },
      "lineNbr": 96,
      "author": {
        "id": 5030
      },
      "writtenOn": "2016-08-25T22:15:46Z",
      "side": 1,
      "message": "i think this should print the URL it tried to download. that\u0027ll make debugging much easier",
      "revId": "6621836c88d4396be5593fb6f078ece6b6efbd46",
      "serverId": "ccdefb6c-23ea-33ff-848c-339fc6ca2269",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "e541c27a_15cb5f1e",
        "filename": "scripts/bootstrap_jiri",
        "patchSetId": 5
      },
      "lineNbr": 96,
      "author": {
        "id": 5015
      },
      "writtenOn": "2016-08-26T17:21:55Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "e541c27a_11e1bcc2",
      "revId": "6621836c88d4396be5593fb6f078ece6b6efbd46",
      "serverId": "ccdefb6c-23ea-33ff-848c-339fc6ca2269",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "e541c27a_71048072",
        "filename": "scripts/bootstrap_jiri",
        "patchSetId": 5
      },
      "lineNbr": 111,
      "author": {
        "id": 5030
      },
      "writtenOn": "2016-08-25T22:15:46Z",
      "side": 1,
      "message": "hm, here you do use -f",
      "revId": "6621836c88d4396be5593fb6f078ece6b6efbd46",
      "serverId": "ccdefb6c-23ea-33ff-848c-339fc6ca2269",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "e541c27a_55de87da",
        "filename": "scripts/bootstrap_jiri",
        "patchSetId": 5
      },
      "lineNbr": 111,
      "author": {
        "id": 5015
      },
      "writtenOn": "2016-08-26T17:21:55Z",
      "side": 1,
      "message": "yeah, in this case i\u0027m not storing the output of curl, so checking the result directly works fine.",
      "parentUuid": "e541c27a_71048072",
      "revId": "6621836c88d4396be5593fb6f078ece6b6efbd46",
      "serverId": "ccdefb6c-23ea-33ff-848c-339fc6ca2269",
      "unresolved": false
    }
  ]
}